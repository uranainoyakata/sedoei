<!DOCTYPE html> 
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>ç”»åƒæš—è¨˜ã‚«ãƒ¼ãƒ‰</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            overscroll-behavior: contain;
            -webkit-user-select: none;
            user-select: none;
        }
        .card-stack {
            perspective: 2000px;
        }
        .card {
            position: absolute;
            inset: 0;
            width: 100%;
            height: 100%;
            cursor: grab;
            will-change: transform;
            transition: transform 0.5s cubic-bezier(0.2, 0.8, 0.2, 1);
            transform-style: preserve-3d;
        }
        .card.dragging {
            transition: none;
        }
        .floating-button {
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            transition: all 0.2s ease;
        }
        .floating-button:active {
            transform: scale(0.95);
        }
        #image-cover {
            height: 25%;
            transition: opacity 0.3s ease-in-out;
        }
    </style>
</head>
<body class="bg-black">
    <div id="main-container" class="relative w-screen h-screen max-w-sm mx-auto bg-black overflow-hidden">
        <div id="card-container" class="absolute inset-x-4 inset-y-16 card-stack">
            <div id="behind-card" class="card bg-gray-800 rounded-2xl shadow-lg" style="transform: translateY(20px) scale(0.95); z-index: 1;">
                <img id="behind-image" src="" class="w-full h-full object-contain rounded-2xl">
            </div>
            <div id="image-card" class="card bg-gray-800 rounded-2xl shadow-xl overflow-hidden" style="z-index: 2;">
                <div id="no-image-placeholder" class="w-full h-full flex flex-col items-center justify-center text-white p-4">
                    <div class="text-8xl mb-6">ğŸ“š</div>
                    <h3 class="text-xl font-semibold text-gray-200 mb-2">å­¦ç¿’ã‚’å§‹ã‚ã‚ˆã†!</h3>
                    <p class="text-gray-400 text-center leading-relaxed">
                        å³ä¸Šã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ã‚¸ãƒ£ãƒ³ãƒ«ã‚’é¸ã‚“ã§  
                        æš—è¨˜ã‚«ãƒ¼ãƒ‰ã‚’é–‹å§‹
                    </p>
                </div>
                <img id="image" src="" alt="æš—è¨˜ç”¨ã®ç”»åƒ" class="w-full h-full object-contain hidden">
                <div id="image-cover" class="absolute bottom-0 left-0 right-0 bg-black/50 backdrop-blur-md flex items-center justify-center p-4">
                    <div class="text-center">
                        <p class="text-white text-lg font-bold" id="answer-text">ç­”ãˆã¯éš ã•ã‚Œã¦ã„ã¾ã™</p>
                        <p class="text-gray-300 text-sm">ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦è¡¨ç¤º</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- ãƒ•ãƒ­ãƒ¼ãƒ†ã‚£ãƒ³ã‚°UI -->
        <div class="absolute top-4 right-4 z-30">
            <button id="genre-menu-btn" class="w-12 h-12 bg-black/30 backdrop-blur-md text-white rounded-full flex items-center justify-center floating-button text-2xl">â˜°</button>
        </div>
        <div class="absolute bottom-6 right-6 z-30">
            <button id="reveal-btn" class="bg-gradient-to-r from-blue-500 to-purple-500 text-white font-semibold py-3 px-5 rounded-full floating-button disabled:opacity-30 disabled:cursor-not-allowed flex items-center gap-2">
                <span id="reveal-btn-icon">ğŸ‘ï¸</span>
                <span id="reveal-btn-text">ç­”ãˆã‚’è¦‹ã‚‹</span>
            </button>
        </div>
    </div>

    <!-- ã‚¸ãƒ£ãƒ³ãƒ«é¸æŠãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div id="genre-modal" class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-8 z-50 hidden">
        <div class="bg-white rounded-2xl shadow-xl w-full max-w-xs p-6">
            <h2 class="text-xl font-bold text-gray-800 mb-1">ã‚¸ãƒ£ãƒ³ãƒ«é¸æŠ</h2>
            <p class="text-sm text-gray-500 mb-6">å­¦ç¿’ã—ãŸã„ã‚¸ãƒ£ãƒ³ãƒ«ã‚’é¸ã‚“ã§ãã ã•ã„ã€‚</p>
            <select id="genre-select" class="w-full p-3 bg-gray-100 border border-gray-200 rounded-xl text-sm font-medium focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition">
                <option value="">ã‚¸ãƒ£ãƒ³ãƒ«ã‚’é¸æŠ âœ¨</option>
            </select>
            <button id="close-modal-btn" class="mt-6 w-full bg-gray-200 text-gray-700 font-semibold py-3 px-6 rounded-xl">é–‰ã˜ã‚‹</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const imageData = {
                "GUCCIã‹ã°ã‚“": { path: "images/gushikaban/", count: 56, extension: "jpeg" },
                "ç§‘å­¦": { path: "images/science/", count: 2, extension: "png" },
                "ç¾è¡“": { path: "images/art/", count: 2, extension: "jpg" }
            };

            const genreSelect = document.getElementById('genre-select');
            const imageCard = document.getElementById('image-card');
            const imageElem = document.getElementById('image');
            const imageCover = document.getElementById('image-cover');
            const answerText = document.getElementById('answer-text');
            const revealBtn = document.getElementById('reveal-btn');
            const revealBtnText = document.getElementById('reveal-btn-text');
            const revealBtnIcon = document.getElementById('reveal-btn-icon');
            const placeholder = document.getElementById('no-image-placeholder');
            const genreMenuBtn = document.getElementById('genre-menu-btn');
            const genreModal = document.getElementById('genre-modal');
            const closeModalBtn = document.getElementById('close-modal-btn');
            const behindCard = document.getElementById('behind-card');
            const behindImage = document.getElementById('behind-image');

            let currentGenreInfo = null;
            let currentImageNumber = 1;
            let nextImageNumber = 2;
            let isDragging = false;
            let startX = 0, currentX = 0;
            let isAnswerVisible = false;

            function getImagePath(genreInfo, imageNumber) {
                return `${genreInfo.path}${imageNumber}.${genreInfo.extension}`;
            }

            function updateCards() {
                if (!currentGenreInfo) {
                    showPlaceholder();
                    return;
                }
                hidePlaceholder();

                imageElem.src = getImagePath(currentGenreInfo, currentImageNumber);
                answerText.textContent = `${genreSelect.value} #${currentImageNumber}`;
                behindImage.src = getImagePath(currentGenreInfo, nextImageNumber);

                isAnswerVisible = false;
                imageCover.classList.remove('opacity-0');
                revealBtnText.textContent = 'ç­”ãˆã‚’è¦‹ã‚‹';
                revealBtnIcon.textContent = 'ğŸ‘ï¸';
                imageCard.style.transform = 'translateX(0) rotate(0deg)';
            }

            function showPlaceholder() {
                placeholder.classList.remove('hidden');
                imageElem.classList.add('hidden');
                imageCover.classList.add('opacity-0');
                behindCard.classList.add('hidden');
                revealBtn.disabled = true;
            }

            function hidePlaceholder() {
                placeholder.classList.add('hidden');
                imageElem.classList.remove('hidden');
                behindCard.classList.remove('hidden');
                revealBtn.disabled = false;
            }

            function handleGenreChange() {
                const selectedGenre = genreSelect.value;
                if (!selectedGenre) {
                    currentGenreInfo = null;
                    showPlaceholder();
                    return;
                }
                currentGenreInfo = imageData[selectedGenre];
                currentImageNumber = 1;
                nextImageNumber = 2;
                updateCards();
                genreModal.classList.add('hidden');
            }

            function handleDragStart(e) {
                if (!currentGenreInfo || e.target === revealBtn || revealBtn.contains(e.target)) return;
                isDragging = true;
                startX = e.pageX || e.touches[0].pageX;
                imageCard.classList.add('dragging');
            }

            function handleDragMove(e) {
                if (!isDragging) return;
                e.preventDefault();
                currentX = e.pageX || e.touches[0].pageX;
                const diffX = currentX - startX;
                const rotation = diffX / 20;
                imageCard.style.transform = `translateX(${diffX}px) rotate(${rotation}deg)`;
            }

            function handleDragEnd() {
                if (!isDragging) return;
                isDragging = false;
                imageCard.classList.remove('dragging');

                const diffX = currentX - startX;
                const threshold = window.innerWidth / 4;

                if (diffX > threshold) {
                    imageCard.style.transform = `translateX(${window.innerWidth}px) rotate(30deg)`;
                    currentImageNumber = (currentImageNumber - 2 + currentGenreInfo.count) % currentGenreInfo.count + 1;
                    nextImageNumber = currentImageNumber % currentGenreInfo.count + 1;
                } else if (diffX < -threshold) {
                    imageCard.style.transform = `translateX(-${window.innerWidth}px) rotate(-30deg)`;
                    currentImageNumber = nextImageNumber;
                    nextImageNumber = (currentImageNumber % currentGenreInfo.count) + 1;
                } else {
                    imageCard.style.transform = 'translateX(0) rotate(0deg)';
                    return;
                }

                setTimeout(updateCards, 200);
            }

            Object.keys(imageData).forEach(genre => {
                const option = document.createElement('option');
                option.value = genre;
                option.textContent = genre;
                genreSelect.appendChild(option);
            });

            genreSelect.addEventListener('change', handleGenreChange);

            revealBtn.addEventListener('click', () => {
                isAnswerVisible = !isAnswerVisible;
                imageCover.classList.toggle('opacity-0', isAnswerVisible);
                revealBtnText.textContent = isAnswerVisible ? 'éš ã™' : 'ç­”ãˆã‚’è¦‹ã‚‹';
                revealBtnIcon.textContent = isAnswerVisible ? 'âœ…' : 'ğŸ‘ï¸';
            });

            genreMenuBtn.addEventListener('click', () => genreModal.classList.remove('hidden'));
            closeModalBtn.addEventListener('click', () => genreModal.classList.add('hidden'));
            genreModal.addEventListener('click', (e) => {
                if (e.target === genreModal) genreModal.classList.add('hidden');
            });

            imageCard.addEventListener('mousedown', handleDragStart);
            imageCard.addEventListener('mousemove', handleDragMove);
            imageCard.addEventListener('mouseup', handleDragEnd);
            imageCard.addEventListener('mouseleave', handleDragEnd);

            imageCard.addEventListener('touchstart', handleDragStart, { passive: true });
            imageCard.addEventListener('touchmove', handleDragMove, { passive: false });
            imageCard.addEventListener('touchend', handleDragEnd);

            showPlaceholder();
        });
    </script>
</body>
</html>




